
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Using Drake from Python &#8212; Drake Documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Using Drake from Julia" href="julia_bindings.html" />
    <link rel="prev" title="Credits" href="credits.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="julia_bindings.html" title="Using Drake from Julia"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="credits.html" title="Credits"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Drake Documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-drake-from-python">
<span id="python-bindings"></span><h1>Using Drake from Python<a class="headerlink" href="#using-drake-from-python" title="Permalink to this headline">¶</a></h1>
<p>A substantial subset of the Drake C++ functionality is available from Python.
The Drake Python bindings are generated using <a class="reference external" href="https://github.com/pybind/pybind11">pybind11</a>, which means that every function or
class which is exposed to C++ has been explicitly enumerated in one of the
source files inside the <code class="docutils literal"><span class="pre">bindings/pydrake</span></code> folder. These bindings are
installed as a single package called <code class="docutils literal"><span class="pre">pydrake</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Drake is incompatible with the Python environment supplied by Anaconda.
Please uninstall Anaconda or remove the Anaconda <code class="docutils literal"><span class="pre">bin</span></code> directory from the
<code class="docutils literal"><span class="pre">PATH</span></code> before building or using the Drake Python bindings.</p>
</div>
<div class="section" id="installation">
<span id="python-bindings-binary"></span><h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Before attempting installation, please review the
<a class="reference internal" href="developers.html#supported-configurations"><span class="std std-ref">supported configurations</span></a> to know what
versions of Python are supported for your platform.</p>
<div class="section" id="binary-installation-for-python">
<h3>Binary Installation for Python<a class="headerlink" href="#binary-installation-for-python" title="Permalink to this headline">¶</a></h3>
<p>First, download and extract an <a class="reference internal" href="from_binary.html#binary-installation"><span class="std std-ref">available binary package</span></a>.</p>
<p>As an example, here is how to download and extract one of the latest releases
to <code class="docutils literal"><span class="pre">/opt</span></code> (where <code class="docutils literal"><span class="pre">&lt;platform&gt;</span></code> could be <code class="docutils literal"><span class="pre">bionic</span></code>, <code class="docutils literal"><span class="pre">focal</span></code>, or <code class="docutils literal"><span class="pre">mac</span></code>):</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>curl -o drake.tar.gz https://drake-packages.csail.mit.edu/drake/nightly/drake-latest-&lt;platform&gt;.tar.gz
rm -rf /opt/drake
tar -xvzf drake.tar.gz -C /opt
</pre></div>
</div>
<p>Ensure that you have the system dependencies:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>/opt/drake/share/drake/setup/install_prereqs
</pre></div>
</div>
<p>Next, ensure that your <code class="docutils literal"><span class="pre">PYTHONPATH</span></code> is properly configured.</p>
<p><em>Ubuntu 18.04 (Bionic):</em></p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span>/opt/drake/lib/python3.6/site-packages:<span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span>
</pre></div>
</div>
<p><em>Ubuntu 20.04 (Focal):</em></p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span>/opt/drake/lib/python3.8/site-packages:<span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span>
</pre></div>
</div>
<p><em>macOS:</em></p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span>/opt/drake/lib/python3.8/site-packages:<span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#using-python-bindings"><span class="std std-ref">below</span></a> for usage instructions.</p>
<div class="section" id="inside-virtualenv">
<h4>Inside <code class="docutils literal"><span class="pre">virtualenv</span></code><a class="headerlink" href="#inside-virtualenv" title="Permalink to this headline">¶</a></h4>
<p>At present, Drake is not installable via <code class="docutils literal"><span class="pre">pip</span></code>. However, you can still
incorporate its install tree into a <code class="docutils literal"><span class="pre">virtualenv</span></code>
<a class="reference external" href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">FHS</a>-like
environment.</p>
<p>An example, where you should replace <code class="docutils literal"><span class="pre">&lt;venv_path&gt;</span></code> and <code class="docutils literal"><span class="pre">&lt;platform&gt;</span></code>:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="c1"># Setup drake, and run prerequisites.</span>
curl -o drake.tar.gz https://drake-packages.csail.mit.edu/drake/nightly/drake-latest-&lt;platform&gt;.tar.gz
mkdir -p &lt;venv_path&gt;
tar -xvzf drake.tar.gz -C &lt;venv_path&gt; --strip-components<span class="o">=</span><span class="m">1</span>
<span class="c1"># - You may need `sudo` here.</span>
&lt;venv_path&gt;/share/drake/setup/install_prereqs

<span class="c1"># Setup a virtualenv over the drake install.</span>
python3 -m virtualenv -p python3 &lt;venv_path&gt; --system-site-packages
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can extract Drake into an existing <code class="docutils literal"><span class="pre">virtualenv</span></code> tree if you have
already run <code class="docutils literal"><span class="pre">install_prereqs</span></code>; however, you should ensure that you have
run <code class="docutils literal"><span class="pre">install_prereqs</span></code>. Before you do this, you should capture / freeze
your current requirements to reproduce your environment if there are
conflicts.</p>
</div>
<p>To check if this worked, follow the instructions as
<a class="reference internal" href="#using-python-bindings"><span class="std std-ref">shown below</span></a>, but either:</p>
<ul class="simple">
<li>Use <code class="docutils literal"><span class="pre">&lt;venv_path&gt;/bin/python</span></code> instead of <code class="docutils literal"><span class="pre">python3</span></code>, or</li>
<li>Source <code class="docutils literal"><span class="pre">&lt;venv_path&gt;/bin/activate</span></code> in your current shell session.</li>
</ul>
</div>
</div>
<div class="section" id="building-the-python-bindings">
<h3>Building the Python Bindings<a class="headerlink" href="#building-the-python-bindings" title="Permalink to this headline">¶</a></h3>
<p>To use the Python bindings from Drake externally, we recommend using CMake.
As an example:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>git clone https://github.com/RobotLocomotion/drake.git
mkdir drake-build
<span class="nb">cd</span> drake-build
cmake ../drake
make -j
</pre></div>
</div>
<p>Please note the additional CMake options which affect the Python bindings:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">-DWITH_GUROBI={ON,</span> <span class="pre">[OFF]}</span></code> - Build with Gurobi enabled.</li>
<li><code class="docutils literal"><span class="pre">-DWITH_MOSEK={ON,</span> <span class="pre">[OFF]}</span></code> - Build with MOSEK enabled.</li>
<li><code class="docutils literal"><span class="pre">-DWITH_SNOPT={ON,</span> <span class="pre">[OFF]}</span></code> - Build with SNOPT enabled.</li>
</ul>
<p><code class="docutils literal"><span class="pre">{...}</span></code> means a list of options, and the option surrounded by <code class="docutils literal"><span class="pre">[...]</span></code> is
the default option. An example of building <code class="docutils literal"><span class="pre">pydrake</span></code> with both Gurobi and
MOSEK, without building tests:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>cmake -DWITH_GUROBI<span class="o">=</span>ON -DWITH_MOSEK<span class="o">=</span>ON ../drake
</pre></div>
</div>
<p>You will also need to have your <code class="docutils literal"><span class="pre">PYTHONPATH</span></code> configured correctly.</p>
<p><em>Ubuntu 18.04 (Bionic):</em></p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nb">cd</span> drake-build
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/install/lib/python3.6/site-packages:<span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span>
</pre></div>
</div>
<p><em>Ubuntu 20.04 (Focal):</em></p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nb">cd</span> drake-build
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/install/lib/python3.8/site-packages:<span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span>
</pre></div>
</div>
<p><em>macOS:</em></p>
<div class="highlight-shell"><div class="highlight"><pre><span></span><span class="nb">cd</span> drake-build
<span class="nb">export</span> <span class="nv">PYTHONPATH</span><span class="o">=</span><span class="si">${</span><span class="nv">PWD</span><span class="si">}</span>/install/lib/python3.8/site-packages:<span class="si">${</span><span class="nv">PYTHONPATH</span><span class="si">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-the-python-bindings">
<span id="using-python-bindings"></span><h2>Using the Python Bindings<a class="headerlink" href="#using-the-python-bindings" title="Permalink to this headline">¶</a></h2>
<div class="section" id="check-installation">
<h3>Check Installation<a class="headerlink" href="#check-installation" title="Permalink to this headline">¶</a></h3>
<p>After following the above install steps, check to ensure you can import
<code class="docutils literal"><span class="pre">pydrake</span></code>.</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>python3 -c <span class="s1">&#39;import pydrake; print(pydrake.__file__)&#39;</span>
</pre></div>
</div>
<div class="admonition note" id="using-python-mac-os-path">
<p class="first admonition-title">Note</p>
<p class="last">If you are using Gurobi, you must either have it installed in the suggested
location under <code class="docutils literal"><span class="pre">/opt/...</span></code> mentioned in <a class="reference internal" href="bazel.html#gurobi"><span class="std std-ref">Gurobi 9.0.2</span></a>, or you must ensure
that you define the <code class="docutils literal"><span class="pre">${GUROBI_HOME}</span></code> environment variable, or specify
<code class="docutils literal"><span class="pre">${GUROBI_INCLUDE_DIR}</span></code> via CMake.</p>
</div>
</div>
<div class="section" id="what-s-available-from-python">
<span id="whats-available-from-python"></span><h3>What’s Available from Python<a class="headerlink" href="#what-s-available-from-python" title="Permalink to this headline">¶</a></h3>
<p>You should first browse the <a class="reference external" href="pydrake/index.html#://">Python API</a> to see what
modules are available. The most up-to-date high-level demonstrations of what
can be done using <code class="docutils literal"><span class="pre">pydrake</span></code> are in Drake’s <a class="reference internal" href="index.html#tutorials"><span class="std std-ref">Tutorials</span></a> and
the <a class="reference external" href="http://underactuated.mit.edu/">Underactuated Robotics Textbook</a>.</p>
<p>You can also see lower-level usages of the API in the <code class="docutils literal"><span class="pre">pydrake</span></code> unit tests
themselves, which you can find inside of the
<code class="docutils literal"><span class="pre">drake/bindings/python/pydrake/**/test</span></code> folders in the Drake source code.</p>
<p>Here’s an example snippet of code from <code class="docutils literal"><span class="pre">pydrake</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydrake.common</span> <span class="kn">import</span> <span class="n">FindResourceOrThrow</span>
<span class="kn">from</span> <span class="nn">pydrake.multibody.parsing</span> <span class="kn">import</span> <span class="n">Parser</span>
<span class="kn">from</span> <span class="nn">pydrake.multibody.plant</span> <span class="kn">import</span> <span class="n">AddMultibodyPlantSceneGraph</span>
<span class="kn">from</span> <span class="nn">pydrake.systems.analysis</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span> <span class="nn">pydrake.systems.framework</span> <span class="kn">import</span> <span class="n">DiagramBuilder</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">DiagramBuilder</span><span class="p">()</span>
<span class="n">plant</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">AddMultibodyPlantSceneGraph</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">Parser</span><span class="p">(</span><span class="n">plant</span><span class="p">)</span><span class="o">.</span><span class="n">AddModelFromFile</span><span class="p">(</span>
    <span class="n">FindResourceOrThrow</span><span class="p">(</span><span class="s2">&quot;drake/examples/pendulum/Pendulum.urdf&quot;</span><span class="p">))</span>
<span class="n">plant</span><span class="o">.</span><span class="n">Finalize</span><span class="p">()</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">Build</span><span class="p">()</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are prototyping code in a REPL environment (such as IPython / Jupyter)
and to reduce the number of import statements, consider using <code class="docutils literal"><span class="pre">pydrake.all</span></code> to
import a subset of symbols from a flattened namespace or import all modules
automatically. If you are writing non-prototype code, avoid using
<code class="docutils literal"><span class="pre">pydrake.all</span></code>; for more details, see <code class="docutils literal"><span class="pre">help(pydrake.all)</span></code>.</p>
<p>In all cases, try to avoid using <code class="docutils literal"><span class="pre">from</span> <span class="pre">pydrake.all</span> <span class="pre">import</span> <span class="pre">*</span></code>, as it may
introduce symbol collisions that are difficult to debug.</p>
<p>The above example, but using <code class="docutils literal"><span class="pre">pydrake.all</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pydrake.all</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AddMultibodyPlantSceneGraph</span><span class="p">,</span> <span class="n">DiagramBuilder</span><span class="p">,</span> <span class="n">FindResourceOrThrow</span><span class="p">,</span>
    <span class="n">Parser</span><span class="p">,</span> <span class="n">Simulator</span><span class="p">)</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">DiagramBuilder</span><span class="p">()</span>
<span class="n">plant</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">AddMultibodyPlantSceneGraph</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">Parser</span><span class="p">(</span><span class="n">plant</span><span class="p">)</span><span class="o">.</span><span class="n">AddModelFromFile</span><span class="p">(</span>
    <span class="n">FindResourceOrThrow</span><span class="p">(</span><span class="s2">&quot;drake/examples/pendulum/Pendulum.urdf&quot;</span><span class="p">))</span>
<span class="n">plant</span><span class="o">.</span><span class="n">Finalize</span><span class="p">()</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">Build</span><span class="p">()</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
</pre></div>
</div>
<p>An alternative is to use <code class="docutils literal"><span class="pre">pydrake.all</span></code> to import all modules, but then
explicitly refer to each symbol:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pydrake.all</span>

<span class="n">builder</span> <span class="o">=</span> <span class="n">pydrake</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">DiagramBuilder</span><span class="p">()</span>
<span class="n">plant</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pydrake</span><span class="o">.</span><span class="n">multibody</span><span class="o">.</span><span class="n">plant</span><span class="o">.</span><span class="n">AddMultibodyPlantSceneGraph</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">pydrake</span><span class="o">.</span><span class="n">multibody</span><span class="o">.</span><span class="n">parsing</span><span class="o">.</span><span class="n">Parser</span><span class="p">(</span><span class="n">plant</span><span class="p">)</span><span class="o">.</span><span class="n">AddModelFromFile</span><span class="p">(</span>
    <span class="n">pydrake</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">FindResourceOrThrow</span><span class="p">(</span>
        <span class="s2">&quot;drake/examples/pendulum/Pendulum.urdf&quot;</span><span class="p">))</span>
<span class="n">plant</span><span class="o">.</span><span class="n">Finalize</span><span class="p">()</span>
<span class="n">diagram</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">Build</span><span class="p">()</span>
<span class="n">simulator</span> <span class="o">=</span> <span class="n">pydrake</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">Simulator</span><span class="p">(</span><span class="n">diagram</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="differences-with-c-api">
<h3>Differences with C++ API<a class="headerlink" href="#differences-with-c-api" title="Permalink to this headline">¶</a></h3>
<p>In general, the <a class="reference external" href="pydrake/index.html#://">Python API</a> should be close to the
<a class="reference external" href="doxygen_cxx/index.html#://">C++ API</a>. There are some exceptions:</p>
<div class="section" id="c-class-template-instantiations-in-python">
<h4>C++ Class Template Instantiations in Python<a class="headerlink" href="#c-class-template-instantiations-in-python" title="Permalink to this headline">¶</a></h4>
<p>When you define a general class template, e.g.
<code class="docutils literal"><span class="pre">template</span> <span class="pre">&lt;typename</span> <span class="pre">T&gt;</span> <span class="pre">class</span> <span class="pre">Value</span></code>, something like <code class="docutils literal"><span class="pre">Value&lt;std::string&gt;</span></code> is
called the instantiation.</p>
<p>For certain C++ templated types, they are exposed in Pythons also as templates;
the parameter types (in this case, <code class="docutils literal"><span class="pre">T</span></code>) are the Python-equivalent types to the
C++ type. Some examples:</p>
<table border="1" class="docutils">
<colgroup>
<col width="46%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">C++</th>
<th class="head">Python</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">std::string</span></code></td>
<td><code class="docutils literal"><span class="pre">str</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">double</span></code></td>
<td><code class="docutils literal"><span class="pre">float</span></code>, <code class="docutils literal"><span class="pre">np.double</span></code>,
<code class="docutils literal"><span class="pre">np.float64</span></code>, <code class="docutils literal"><span class="pre">ctypes.c_double</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">drake::AutoDiffXd</span></code></td>
<td><code class="docutils literal"><span class="pre">pydrake.autodiffutils.AutoDiffXd</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">drake::symbolic::Expression</span></code></td>
<td><code class="docutils literal"><span class="pre">pydrake.symbolic.Expression</span></code></td>
</tr>
</tbody>
</table>
<p>Thus, the instantiation <code class="docutils literal"><span class="pre">Value&lt;std::string&gt;</span></code> will be bound in Python as
<code class="docutils literal"><span class="pre">Value[str]</span></code>.</p>
</div>
<div class="section" id="scalar-types">
<h4>Scalar Types<a class="headerlink" href="#scalar-types" title="Permalink to this headline">¶</a></h4>
<p>Most classes in the Systems framework and in the multibody dynamics
computational framework are templated on a scalar type, <code class="docutils literal"><span class="pre">T</span></code>.
For convenience (and backwards compatibility) in Python, a slightly different
binding convention is used.</p>
<p>For example, <code class="docutils literal"><span class="pre">Adder&lt;T&gt;</span></code> is a Systems primitive which has a user-defined
number of inputs and outputs a single port which is the sum of all of the
inputs.</p>
<p>In C++, you would access the instantiations using <code class="docutils literal"><span class="pre">Adder&lt;double&gt;</span></code>,
<code class="docutils literal"><span class="pre">Adder&lt;AutoDiffXd&gt;</span></code>, and <code class="docutils literal"><span class="pre">Adder&lt;Expression&gt;</span></code> for common scalar types.</p>
<p>In Python, <code class="docutils literal"><span class="pre">Adder</span></code> actually refers to the “default” instantiation, the
<code class="docutils literal"><span class="pre">Adder&lt;double&gt;</span></code> C++ class. To access other instantiations, you should add an
<code class="docutils literal"><span class="pre">_</span></code> to the end of the C++ class name to get the Python template and then
provide the parameters in square braces, <code class="docutils literal"><span class="pre">[...]</span></code>. In this example, you should
use <code class="docutils literal"><span class="pre">Adder_[T]</span></code>.</p>
<p>To illustrate, you can print out the string representations of <code class="docutils literal"><span class="pre">Adder</span></code>,
<code class="docutils literal"><span class="pre">Adder_</span></code>, and some of its instantiations in Python:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydrake.systems.primitives</span> <span class="kn">import</span> <span class="n">Adder</span><span class="p">,</span> <span class="n">Adder_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">Adder</span><span class="p">)</span>
<span class="go">&lt;class &#39;pydrake.systems.primitives.Adder_[float]&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">Adder_</span><span class="p">)</span>
<span class="go">&lt;TemplateClass pydrake.systems.primitives.Adder_&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydrake.autodiffutils</span> <span class="kn">import</span> <span class="n">AutoDiffXd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pydrake.symbolic</span> <span class="kn">import</span> <span class="n">Expression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">Adder_</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span>
<span class="go">&lt;class &#39;pydrake.systems.primitives.Adder_[float]&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">Adder_</span><span class="p">[</span><span class="n">AutoDiffXd</span><span class="p">])</span>
<span class="go">&lt;class &#39;pydrake.systems.primitives.Adder_[AutoDiffXd]&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">Adder_</span><span class="p">[</span><span class="n">Expression</span><span class="p">])</span>
<span class="go">&lt;class &#39;pydrake.systems.primitives.Adder_[Expression]&#39;&gt;</span>
</pre></div>
</div>
<p>Additionally, you may convert an instance (if the conversion is available) using
<code class="docutils literal"><span class="pre">System_[T].ToAutoDiffXd</span></code> and <code class="docutils literal"><span class="pre">System_[T].ToSymbolic</span></code>:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">adder</span> <span class="o">=</span> <span class="n">Adder</span><span class="p">(</span><span class="n">num_inputs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">adder</span><span class="p">)</span>
<span class="go">&lt;pydrake.systems.primitives.Adder_[float] object at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">adder</span><span class="o">.</span><span class="n">ToAutoDiffXd</span><span class="p">())</span>
<span class="go">&lt;pydrake.systems.primitives.Adder_[AutoDiffXd] object at 0x...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">adder</span><span class="o">.</span><span class="n">ToSymbolic</span><span class="p">())</span>
<span class="go">&lt;pydrake.systems.primitives.Adder_[Expression] object at 0x...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="c-function-and-method-template-instantiations-in-python">
<h4>C++ Function and Method Template Instantiations in Python<a class="headerlink" href="#c-function-and-method-template-instantiations-in-python" title="Permalink to this headline">¶</a></h4>
<p>The above section indicates that C++ types are generally registered with
Python, and a similar approach could be used for function and method templates.
However, these templates usually fit a certain pattern and can be Pythonized in
such a way that simplifies implementation, but may change the “feel” of the
signature.</p>
<p>Two common (non-metaprogramming) applications of templated functions and
methods present in Drake are <a class="reference external" href="https://en.cppreference.com/w/cpp/container/vector/emplace">emplace</a>-like
functionality (using <a class="reference external" href="https://en.cppreference.com/w/cpp/language/parameter_pack">parameter packs</a>) and
<a class="reference external" href="https://en.wikipedia.org/wiki/Type_erasure">type erasure</a>.
However, Python doesn’t literally support these C++ language features. So, in
binding them, they get “Pythonized”.</p>
<p>C++ APIs which use parameter packs, such as:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">DiagramBuilder</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">AddSystem</span><span class="o">&lt;</span><span class="n">SystemType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">args</span><span class="p">...)</span>
<span class="n">MultibodyPlant</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">AddJoint</span><span class="o">&lt;</span><span class="n">JointType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">args</span><span class="p">...)</span>
<span class="n">MultibodyPlant</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">AddFrame</span><span class="o">&lt;</span><span class="n">FrameType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">args</span><span class="p">...)</span>
</pre></div>
</div>
<p>will become the following in Python:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span></span><span class="go">DiagramBuilder_[T].AddSystem(SystemType(args, ...))</span>
<span class="go">MultibodyPlant_[T].AddJoint(JointType(args, ...))</span>
<span class="go">MultibodyPlant_[T].AddFrame(FrameType(args, ...))</span>
</pre></div>
</div>
<p>where the <code class="docutils literal"><span class="pre">*Type</span></code> tokens are replaced with the concrete type in question
(e.g. <code class="docutils literal"><span class="pre">Adder_[T]</span></code>, <code class="docutils literal"><span class="pre">RevoluteJoint_[T]</span></code>, <code class="docutils literal"><span class="pre">FixedOffsetFrame_[T]</span></code>).</p>
<p>Similarly, type-erasure C++ APIs that look like:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">InputPort</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;::</span><span class="n">Eval</span><span class="o">&lt;</span><span class="n">ValueType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="n">GeometryProperties</span><span class="o">::</span><span class="n">AddProperty</span><span class="o">&lt;</span><span class="n">ValueType</span><span class="o">&gt;</span><span class="p">(</span><span class="n">group_name</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
<p>will become the following in Python:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span></span><span class="go">InputPort_[T].Eval(context)</span>
<span class="go">GeometryProperties.AddProperty(group_name, name, value)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="debugging-with-the-python-bindings">
<h3>Debugging with the Python Bindings<a class="headerlink" href="#debugging-with-the-python-bindings" title="Permalink to this headline">¶</a></h3>
<p>You may encounter issues with the Python Bindings that may arise from the
underlying C++ code, and it may not always be obvious what the root cause is.</p>
<p>The first step to debugging is to consider running your code using the
<code class="docutils literal"><span class="pre">trace</span></code> module. It is best practice to always have a <code class="docutils literal"><span class="pre">main()</span></code> function, and
have a <code class="docutils literal"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;</span></code> clause. If you do this, then it is easy to
trace. As an example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reexecute_if_unbuffered</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Ensures that output is immediately flushed (e.g. for segfaults).</span>
<span class="sd">    ONLY use this at your entrypoint. Otherwise, you may have code be</span>
<span class="sd">    re-executed that will clutter your console.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">shlex</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;PYTHONUNBUFFERED&quot;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;PYTHONUNBUFFERED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
        <span class="n">argv</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">:</span>
            <span class="n">argv</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">executable</span><span class="p">)</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">shlex</span><span class="o">.</span><span class="n">quote</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">argv</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">execv</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">argv</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">traced</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">ignoredirs</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decorates func such that its execution is traced, but filters out any</span>
<span class="sd">     Python code outside of the system prefix.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">functools</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">import</span> <span class="nn">trace</span>
    <span class="k">if</span> <span class="n">ignoredirs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">ignoredirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;/usr&quot;</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">prefix</span><span class="p">]</span>
    <span class="n">tracer</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">Trace</span><span class="p">(</span><span class="n">trace</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ignoredirs</span><span class="o">=</span><span class="n">ignoredirs</span><span class="p">)</span>

    <span class="nd">@functools.wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapped</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tracer</span><span class="o">.</span><span class="n">runfunc</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapped</span>


<span class="c1"># NOTE: You don&#39;t have to trace all of your code. If you can identify a</span>
<span class="c1"># single function, then you can just decorate it with this. If you&#39;re</span>
<span class="c1"># decorating a class method, then be sure to declare these functions above</span>
<span class="c1"># it.</span>
<span class="nd">@traced</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">insert_awesome_code_here</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">reexecute_if_unbuffered</span><span class="p">()</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are developing in Drake and are using the <code class="docutils literal"><span class="pre">drake_py_unittest</span></code>
macro, you can specify the argument <code class="docutils literal"><span class="pre">--trace=user</span></code> to get the same
behavior.</p>
</div>
<p>This generally should help you trace where the code is dying. However, if you
still need to dig in, you can build the bindings in debug mode, without symbol
stripping, so you can debug with <code class="docutils literal"><span class="pre">gdb</span></code> or <code class="docutils literal"><span class="pre">lldb</span></code>:</p>
<div class="highlight-shell"><div class="highlight"><pre><span></span>cmake -DCMAKE_BUILD_TYPE<span class="o">=</span>Debug ../drake
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you have SNOPT enabled (either <code class="docutils literal"><span class="pre">-DWITH_SNOPT=ON</span></code> or
<code class="docutils literal"><span class="pre">-DWITH_ROBOTLOCOMOTION_SNOPT=ON</span></code>), symbols will <em>still</em> be stripped.</p>
</div>
</div>
<div class="section" id="for-developers">
<h3>For Developers<a class="headerlink" href="#for-developers" title="Permalink to this headline">¶</a></h3>
<p>If you are developing Python bindings, please see the Doxygen page
<a class="reference external" href="https://drake.mit.edu/doxygen_cxx/group__python__bindings.html">Python Bindings</a> which provides information on programming conventions, documentation, tips
for debugging, and other advice.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Drake Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Quickstart</a></li>
<li class="toctree-l1"><a class="reference external" href="https://drake.mit.edu/#tutorials-and-examples">Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="doxygen_cxx/index.html#://">API Documentation (C++)</a></li>
<li class="toctree-l1"><a class="reference external" href="pydrake/index.html#://">API Documentation (Python)</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_help.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="developers.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/RobotLocomotion/drake">GitHub</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using Drake from Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="julia_bindings.html">Using Drake from Julia</a></li>
</ul>

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Drake from Python</a><ul>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#binary-installation-for-python">Binary Installation for Python</a><ul>
<li><a class="reference internal" href="#inside-virtualenv">Inside <code class="docutils literal"><span class="pre">virtualenv</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-the-python-bindings">Building the Python Bindings</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-python-bindings">Using the Python Bindings</a><ul>
<li><a class="reference internal" href="#check-installation">Check Installation</a></li>
<li><a class="reference internal" href="#what-s-available-from-python">What’s Available from Python</a></li>
<li><a class="reference internal" href="#differences-with-c-api">Differences with C++ API</a><ul>
<li><a class="reference internal" href="#c-class-template-instantiations-in-python">C++ Class Template Instantiations in Python</a></li>
<li><a class="reference internal" href="#scalar-types">Scalar Types</a></li>
<li><a class="reference internal" href="#c-function-and-method-template-instantiations-in-python">C++ Function and Method Template Instantiations in Python</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debugging-with-the-python-bindings">Debugging with the Python Bindings</a></li>
<li><a class="reference internal" href="#for-developers">For Developers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="julia_bindings.html" title="Using Drake from Julia"
             >next</a> |</li>
        <li class="right" >
          <a href="credits.html" title="Credits"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Drake Documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright Robot Locomotion Group (MIT).
    </div>
  </body>
</html>